var fs = require('fs');
var util = require('util');
var dateFormat = require('./dateformat');

var tfd = null;

function inittrade(appName, verName) {
    var  now = new Date();
    path = './' + appName + 'trade' + now.format('isoDate') + '.log';
    tfd= fs.createWriteStream(path, {flags:'a', encoding:null, mode: 0666});
}

function trade(msg) {
    if (tfd != null) {
        var outstr = msg + '\r\n';
        tfd.write(outstr);
    }        
}

function objectToString(o){

    var parse = function(_o){
        var a = [], t;
        
        for(var p in _o){      
            if(_o.hasOwnProperty(p)){   
                t = _o[p];
                if(t && typeof t == "object"){                
                        a[a.length]= p + ":{ " + arguments.callee(t).join(", ") + "}";  
                }
                else {
                    if(typeof t == "string"){
                        a[a.length] = [ p+ ": \"" + t.toString() + "\"" ];
                    }
                    else{
                        a[a.length] = [ p+ ": " + t.toString()];
                    }
                }
            }
        }
        return a;
    }
    return o.constructor.name + " {" + parse(o).join(", ") + "}";
}

exports.toStr = util.inspect;
exports.inittrade = inittrade;
exports.trade = trade;
